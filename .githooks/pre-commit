#!/usr/bin/env sh

LOCAL_HOOK="$0.local"
if [ -f "$LOCAL_HOOK" ]; then
	sh "$LOCAL_HOOK"
	status=$?
	if [ $status -ne 0 ]; then
		exit $status
	fi
fi

if command -v pre-commit >/dev/null 2>&1; then
	pre-commit run --hook-stage pre-commit
	exit $?
fi

if command -v py >/dev/null 2>&1 && py -m pre_commit --version >/dev/null 2>&1; then
	py -m pre_commit run --hook-stage pre-commit
	exit $?
fi

if command -v python >/dev/null 2>&1 && python -m pre_commit --version >/dev/null 2>&1; then
	python -m pre_commit run --hook-stage pre-commit
	exit $?
fi

if command -v python3 >/dev/null 2>&1 && python3 -m pre_commit --version >/dev/null 2>&1; then
	python3 -m pre_commit run --hook-stage pre-commit
	exit $?
fi

echo "[pre-commit] pre-commit is required."
echo "[pre-commit] Install pre-commit and retry commit."
echo "[pre-commit] pipx install pre-commit"
echo "[pre-commit] or: py -m pip install --user pre-commit"
echo "[pre-commit] https://pre-commit.com/#install"
exit 1
